# Decisions (ADR-lite)

軽量な決定記録です（厳密なADRテンプレではありません）。

## D1: 外部 JSON ライブラリを使わない

- 状況: 要件が「余計な外部ライブラリに極力依存しない」。
- 決定: object/array/string/number/bool/null に対応する最小 JSON 実装を同梱。
- 影響:
  - JSON コメント不可
  - 仕様の拡張（日時/数値の厳密性など）は自前で面倒を見る必要あり

## D2: シェル実行を前提にしない

- 状況: 文字列コマンドを shell に渡すとインジェクション面で不利。
- 決定: `exe` と `args[]` で定義し `CreateProcessW` で起動。
- 影響:
  - `&&` やリダイレクト等のシェル機能を使いたい場合は明示的に `cmd.exe` を exe として指定する必要。
  - ただしそれは危険性も上がるので、将来は禁止/制限ポリシーを検討。

## D3: 記録は state.json ではなく config に書き戻す

- 状況: 要件は「設定用 json に前回実行時間が含まれる」。
- 決定: `lastRunUtc` / `lastExitCode` を config 内で更新。
- 影響:
  - config が更新されるため、読み取り専用運用はできない。
  - 分離が必要になった場合は `state.json` 方式に移行可能。
